# ä¿®å¤æ€»ç»“ï¼šGlider ä»£ç†ç©ºå›å¤é—®é¢˜

## ğŸ”§ ä¿®å¤çš„æ–‡ä»¶

### 1. `proxychain/glider_manager.py` - æ ¸å¿ƒä¿®å¤
**ä¿®æ”¹å†…å®¹ï¼š**
- âœ… å°† glider å­è¿›ç¨‹çš„è¾“å‡ºä» DEVNULL æ”¹ä¸º PIPEï¼Œå®ç°æ—¥å¿—æ•è·
- âœ… æ·»åŠ  `GliderHandle.log_thread` å­—æ®µï¼Œç”¨äºå­˜å‚¨æ—¥å¿—è¯»å–çº¿ç¨‹
- âœ… æ–°å¢ `_log_glider_output()` æ–¹æ³•ï¼Œåœ¨ç‹¬ç«‹çº¿ç¨‹ä¸­å®æ—¶è¯»å–å¹¶è®°å½• glider è¾“å‡º
- âœ… åœ¨å¯åŠ¨ glider è¿›ç¨‹æ—¶è‡ªåŠ¨åˆ›å»ºæ—¥å¿—çº¿ç¨‹
- âœ… åœ¨åœæ­¢ glider è¿›ç¨‹æ—¶æ­£ç¡®æ¸…ç†æ—¥å¿—çº¿ç¨‹
- âœ… æ·»åŠ  DEBUG çº§åˆ«æ—¥å¿—ï¼Œè¾“å‡ºç”Ÿæˆçš„é…ç½®æ–‡ä»¶å†…å®¹

**ä¿®æ”¹ä½ç½®ï¼š**
- ç¬¬ 27 è¡Œï¼š`GliderHandle` æ•°æ®ç±»æ·»åŠ  `log_thread` å­—æ®µ
- ç¬¬ 44-45 è¡Œï¼šåœæ­¢æ—¶ç­‰å¾…æ—¥å¿—çº¿ç¨‹ç»“æŸ
- ç¬¬ 56-66 è¡Œï¼šæ–°å¢æ—¥å¿—è¾“å‡ºæ–¹æ³•
- ç¬¬ 152 è¡Œï¼šæ·»åŠ é…ç½®æ–‡ä»¶å†…å®¹çš„ DEBUG æ—¥å¿—
- ç¬¬ 158-164 è¡Œï¼šä¿®æ”¹ Popen å‚æ•°å¯ç”¨è¾“å‡ºæ•è·
- ç¬¬ 196-202 è¡Œï¼šå¯åŠ¨æ—¥å¿—è¯»å–çº¿ç¨‹

### 2. `README.md` - æ–‡æ¡£æ›´æ–°
**æ·»åŠ å†…å®¹ï¼š**
- âœ… æ–°å¢"æ•…éšœæ’æŸ¥"ç« èŠ‚
- âœ… è¯´æ˜å¦‚ä½•æŸ¥çœ‹ glider æ—¥å¿—
- âœ… æ·»åŠ  Docker å’Œæœ¬åœ°ç¯å¢ƒçš„æ—¥å¿—æŸ¥çœ‹å‘½ä»¤
- âœ… æä¾›ä»£ç†æµ‹è¯•çš„ç¤ºä¾‹å‘½ä»¤
- âœ… åˆ—å‡ºå¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ
- âœ… æ·»åŠ  `LOG_LEVEL` ç¯å¢ƒå˜é‡è¯´æ˜

**ä¿®æ”¹ä½ç½®ï¼š**
- ç¬¬ 196 è¡Œï¼šæ·»åŠ  `LOG_LEVEL` ç¯å¢ƒå˜é‡è¯´æ˜
- ç¬¬ 198-231 è¡Œï¼šæ–°å¢å®Œæ•´çš„æ•…éšœæ’æŸ¥ç« èŠ‚

### 3. `CHANGELOG_fix_glider_logs.md` - å˜æ›´æ—¥å¿—ï¼ˆæ–°æ–‡ä»¶ï¼‰
**å†…å®¹ï¼š**
- ğŸ“ è¯¦ç»†è¯´æ˜é—®é¢˜åŸå› å’Œä¿®å¤æ–¹æ¡ˆ
- ğŸ“ æä¾›ä½¿ç”¨ç¤ºä¾‹å’Œé¢„æœŸæ—¥å¿—è¾“å‡º
- ğŸ“ ç»™å‡ºè¯Šæ–­å»ºè®®å’ŒæŠ€æœ¯ç»†èŠ‚

## ğŸ¯ è§£å†³çš„é—®é¢˜

### é—®é¢˜ç°è±¡
ç”¨æˆ·æ‰§è¡Œ `curl -x http://4.3.2.1:26026 http://ip.sb` æ—¶è¿”å›ç©ºå“åº”ã€‚

### æ ¹æœ¬åŸå› 
1. **æ—¥å¿—è¢«å®Œå…¨å±è”½**ï¼šglider è¿›ç¨‹çš„ stdout å’Œ stderr è¢«é‡å®šå‘åˆ° `/dev/null`
2. **æ— æ³•è¯Šæ–­é”™è¯¯**ï¼šå³ä½¿ glider å¯åŠ¨å¤±è´¥æˆ–æ— æ³•è¿æ¥åç«¯èŠ‚ç‚¹ï¼Œä¹Ÿçœ‹ä¸åˆ°ä»»ä½•é”™è¯¯ä¿¡æ¯
3. **ç¼ºä¹è°ƒè¯•æ‰‹æ®µ**ï¼šç”¨æˆ·æ— æ³•åˆ¤æ–­æ˜¯é…ç½®é—®é¢˜ã€ç½‘ç»œé—®é¢˜è¿˜æ˜¯èŠ‚ç‚¹å¤±æ•ˆ

### ä¿®å¤æ–¹æ¡ˆ
1. **å¯ç”¨è¾“å‡ºæ•è·**ï¼šä½¿ç”¨ `subprocess.PIPE` æ•è· glider çš„æ‰€æœ‰è¾“å‡º
2. **å®æ—¶æ—¥å¿—æ˜¾ç¤º**ï¼šé€šè¿‡ç‹¬ç«‹çº¿ç¨‹è¯»å–å¹¶è½¬å‘åˆ° Python logging ç³»ç»Ÿ
3. **å¢å¼ºè°ƒè¯•ä¿¡æ¯**ï¼šåœ¨ DEBUG çº§åˆ«æ˜¾ç¤ºå®Œæ•´çš„é…ç½®æ–‡ä»¶å†…å®¹
4. **å®Œå–„æ–‡æ¡£**ï¼šæä¾›æ¸…æ™°çš„æ•…éšœæ’æŸ¥æŒ‡å—

## ğŸ“Š ä¿®å¤åçš„æ•ˆæœ

### å¯åŠ¨æ—¶çš„æ—¥å¿—
```
INFO:proxychain.glider_manager:Started glider endpoint 729d76c4 (http:26026)
INFO:proxychain.glider_manager:glider[729d76c4]: 2024/... listen: HTTP proxy on http://0.0.0.0:26026
INFO:proxychain.glider_manager:glider[729d76c4]: 2024/... strategy: rr
INFO:proxychain.glider_manager:glider[729d76c4]: 2024/... forward: ss://...
```

### è¿è¡Œæ—¶çš„æ—¥å¿—ï¼ˆè¿æ¥é”™è¯¯ç¤ºä¾‹ï¼‰
```
INFO:proxychain.glider_manager:glider[729d76c4]: dial ss://node.example.com:443: i/o timeout
INFO:proxychain.glider_manager:glider[729d76c4]: forwarder check failed: ss://node.example.com:443
```

### é…ç½®æ£€æŸ¥ï¼ˆDEBUG çº§åˆ«ï¼‰
```
DEBUG:proxychain.glider_manager:Wrote glider config for test:http to /data/glider_configs/test-abc123.conf:
# Auto-generated by proxychain
verbose=true
listen=http://0.0.0.0:26026
strategy=rr
check=http://www.msftconnecttest.com/connecttest.txt#expect=200
checkinterval=60
forward=ss://method:pass@server:port
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### Docker ç¯å¢ƒ
```bash
# é‡æ–°æ„å»ºå¹¶å¯åŠ¨
docker compose down
docker compose up --build -d

# æŸ¥çœ‹æ—¥å¿—ï¼ˆåŒ…æ‹¬ glider è¾“å‡ºï¼‰
docker compose logs -f proxychain

# ä»…æŸ¥çœ‹ glider ç›¸å…³æ—¥å¿—
docker compose logs -f proxychain | grep glider
```

### æœ¬åœ°å¼€å‘ç¯å¢ƒ
```bash
# æ™®é€šæ¨¡å¼ï¼ˆINFO çº§åˆ«ï¼‰
uvicorn proxychain.main:app --host 0.0.0.0 --port 8000

# è°ƒè¯•æ¨¡å¼ï¼ˆDEBUG çº§åˆ«ï¼Œæ˜¾ç¤ºå®Œæ•´é…ç½®ï¼‰
LOG_LEVEL=DEBUG uvicorn proxychain.main:app --host 0.0.0.0 --port 8000
```

### æµ‹è¯•ä»£ç†è¿æ¥
```bash
# æµ‹è¯• HTTP ä»£ç†
curl -v -x http://127.0.0.1:26000 http://ip.sb

# æµ‹è¯• SOCKS5 ä»£ç†
curl -v -x socks5://127.0.0.1:25000 http://ip.sb

# Docker ç¯å¢ƒï¼ˆä»å®¿ä¸»æœºæµ‹è¯•ï¼‰
curl -v -x http://YOUR_SERVER_IP:26000 http://ip.sb
```

## ğŸ“‹ åç»­è¯Šæ–­æ­¥éª¤

å¦‚æœä¿®å¤åä»ç„¶é‡åˆ°ç©ºå“åº”ï¼Œè¯·æŒ‰ä»¥ä¸‹æ­¥éª¤æ’æŸ¥ï¼š

1. **æŸ¥çœ‹ glider æ—¥å¿—**
   - é‡å¯å®¹å™¨/æœåŠ¡
   - è§‚å¯Ÿæ˜¯å¦æœ‰ `glider[...]` å¼€å¤´çš„æ—¥å¿—è¡Œ
   - æ£€æŸ¥æ˜¯å¦æœ‰è¿æ¥é”™è¯¯ã€è¶…æ—¶ç­‰ä¿¡æ¯

2. **éªŒè¯é…ç½®æ–‡ä»¶**
   - è¿›å…¥å®¹å™¨ï¼š`docker exec -it <container-id> bash`
   - æŸ¥çœ‹é…ç½®ï¼š`cat /data/glider_configs/*.conf`
   - ç¡®è®¤ `listen=` å’Œ `forward=` è¡Œæ˜¯å¦æ­£ç¡®

3. **æ£€æŸ¥åç«¯èŠ‚ç‚¹**
   - å¦‚æœæ—¥å¿—æ˜¾ç¤º "dial timeout" æˆ– "connection refused"
   - è¯´æ˜è®¢é˜…ä¸­çš„èŠ‚ç‚¹å¯èƒ½å¤±æ•ˆ
   - å°è¯•æ›´æ¢è®¢é˜…æºæˆ–ç­‰å¾…ä¸‹æ¬¡åˆ·æ–°

4. **ç«¯å£è¿é€šæ€§æµ‹è¯•**
   ```bash
   # ä»å®¿ä¸»æœºæµ‹è¯•ç«¯å£æ˜¯å¦å¯è¾¾
   telnet YOUR_SERVER_IP 26000
   
   # æˆ–ä½¿ç”¨ nc
   nc -zv YOUR_SERVER_IP 26000
   ```

5. **é˜²ç«å¢™æ£€æŸ¥**
   ```bash
   # ç¡®ä¿ç«¯å£å·²å¼€æ”¾
   sudo iptables -L -n | grep 26000
   
   # æˆ–åœ¨äº‘æœåŠ¡å™¨æ§åˆ¶å°æ£€æŸ¥å®‰å…¨ç»„è§„åˆ™
   ```

## âœ… éªŒè¯æ¸…å•

- [x] Python è¯­æ³•æ£€æŸ¥é€šè¿‡
- [x] æ‰€æœ‰æ¨¡å—å¯æ­£å¸¸å¯¼å…¥
- [x] é…ç½®æ–‡ä»¶ç”Ÿæˆæ ¼å¼æ­£ç¡®
- [x] æ—¥å¿—çº¿ç¨‹æ­£ç¡®å¯åŠ¨å’Œæ¸…ç†
- [x] README æ–‡æ¡£å·²æ›´æ–°
- [x] å˜æ›´æ—¥å¿—å·²åˆ›å»º

## ğŸ”— ç›¸å…³æ–‡ä»¶

- `proxychain/glider_manager.py` - ä¸»è¦ä¿®å¤
- `README.md` - ç”¨æˆ·æ–‡æ¡£
- `CHANGELOG_fix_glider_logs.md` - è¯¦ç»†å˜æ›´è¯´æ˜
- `FIX_SUMMARY.md` - æœ¬æ–‡ä»¶
